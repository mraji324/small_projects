<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Vue.js Chatbot with Firebase</title>
  <link rel="stylesheet" href="style.css" />
  <!-- Vue.js CDN -->
  <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
</head>
<body>
  <div id="app" class="chat-container">
    <h1>Chatbot</h1>
    <div class="chat-window">
      <div v-for="msg in messages" :key="msg.id" :class="['chat-message', msg.sender]">
        <div class="message-content">{{ msg.text }}</div>
      </div>
    </div>
    <form @submit.prevent="sendMessage" class="input-form">
      <input
        v-model="userInput"
        type="text"
        placeholder="Type your message..."
        autocomplete="off"
        required
      />
      <button type="submit">Send</button>
    </form>
  </div>

  <script>
    // Firebase configuration - replace with your own Firebase project config
       const firebaseConfig = {
    apiKey: "AIzaSyB4xTa2lINTqzAcCCHf-uSYyGB4y_4to5U",
    authDomain: "web-application-24833.firebaseapp.com",
    databaseURL: "https://web-application-24833-default-rtdb.firebaseio.com",
    projectId: "web-application-24833",
    storageBucket: "web-application-24833.firebasestorage.app",
    messagingSenderId: "244072157741",
    appId: "1:244072157741:web:5a75807fe19a3cb6311ea4",
    measurementId: "G-CLY9ZGED63"
  };
    // Initialize Firebase
    const app = firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    const { createApp } = Vue;

    createApp({
      data() {
        return {
          userInput: '',
          messages: []
        };
      },
      created() {
        // Listen for new messages in Firebase Realtime Database
        const messagesRef = database.ref('messages');
        messagesRef.on('child_added', snapshot => {
          const msg = snapshot.val();
          msg.id = snapshot.key;
          this.messages.push(msg);
          this.scrollToBottom();
        });
      },
      methods: {
        sendMessage() {
          if (!this.userInput.trim()) return;

          const userMessage = {
            text: this.userInput,
            sender: 'user',
            timestamp: Date.now()
          };

          // Push user message to Firebase
          const messagesRef = database.ref('messages');
          messagesRef.push(userMessage);

          // Generate bot response
          this.generateBotResponse(this.userInput);

          this.userInput = '';
        },
        generateBotResponse(userText) {
          // Enhanced keyword-based response logic with more prompts and varied answers
          const text = userText.toLowerCase().trim();

          const responses = [
            { keywords: ['hello', 'hi', 'hey'], replies: ['Hello! How can I help you today?', 'Hi there! What can I do for you?', 'Hey! How can I assist you?'] },
            { keywords: ['how are you', 'how are you doing'], replies: ["I'm a bot, but I'm doing great! Thanks for asking.", "I'm here to help you anytime!"] },
            { keywords: ['help', 'support'], replies: ['Sure! Ask me anything or type your message.', 'I am here to assist you. What do you need help with?'] },
            { keywords: ['bye', 'goodbye', 'see you'], replies: ['Goodbye! Have a nice day!', 'See you later! Take care!', 'Bye! Come back soon!'] },
            { keywords: ['thank you', 'thanks'], replies: ['You\'re welcome!', 'No problem!', 'Glad to help!'] },
            { keywords: ['what is your name', 'who are you'], replies: ['I am your friendly chatbot.', 'I am a chatbot here to assist you.'] },
            { keywords: ['weather'], replies: ['I am not connected to weather services yet, but I hope it\'s nice where you are!'] },
            { keywords: ['joke'], replies: ['Why did the computer show up at work late? It had a hard drive!', 'Why do programmers prefer dark mode? Because light attracts bugs!'] }
          ];

          let responseText = "Sorry, I didn't understand that.";

          for (const entry of responses) {
            if (entry.keywords.some(keyword => text.includes(keyword))) {
              const randomIndex = Math.floor(Math.random() * entry.replies.length);
              responseText = entry.replies[randomIndex];
              break;
            }
          }

          const botMessage = {
            text: responseText,
            sender: 'bot',
            timestamp: Date.now()
          };

          // Push bot message to Firebase after a short delay to simulate typing
          setTimeout(() => {
            const messagesRef = database.ref('messages');
            messagesRef.push(botMessage);
          }, 800);
        },
        scrollToBottom() {
          this.$nextTick(() => {
            const chatWindow = this.$el.querySelector('.chat-window');
            chatWindow.scrollTop = chatWindow.scrollHeight;
          });
        }
      }
    }).mount('#app');
  </script>
</body>
</html>